"use strict";(globalThis.webpackChunkgh_docs=globalThis.webpackChunkgh_docs||[]).push([[9461],{2448(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"user-guide/import-session-feature","title":"Sess\xe3o de Importa\xe7\xe3o","description":"Documenta\xe7\xe3o completa da funcionalidade de Import Session para gerenciamento de transa\xe7\xf5es","source":"@site/docs/user-guide/import-session-feature.md","sourceDirName":"user-guide","slug":"/user-guide/import-session-feature","permalink":"/fintrack-docs/docs/user-guide/import-session-feature","draft":false,"unlisted":false,"editUrl":"https://github.com/PHRaulino-Space/fintrack-docs/tree/main/gh-docs/docs/user-guide/import-session-feature.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Sess\xe3o de Importa\xe7\xe3o","description":"Documenta\xe7\xe3o completa da funcionalidade de Import Session para gerenciamento de transa\xe7\xf5es"},"sidebar":"tutorialSidebar","previous":{"title":"Importando Transa\xe7\xf5es","permalink":"/fintrack-docs/docs/user-guide/importing-transactions"},"next":{"title":"Categoriza\xe7\xe3o","permalink":"/fintrack-docs/docs/user-guide/categorization"}}');var r=n(4848),i=n(8453);const a={sidebar_position:7,title:"Sess\xe3o de Importa\xe7\xe3o",description:"Documenta\xe7\xe3o completa da funcionalidade de Import Session para gerenciamento de transa\xe7\xf5es"},c="Sess\xe3o de Importa\xe7\xe3o (Import Session)",o={},t=[{value:"Conceito",id:"conceito",level:2},{value:"Informa\xe7\xf5es Principais de uma Transa\xe7\xe3o",id:"informa\xe7\xf5es-principais-de-uma-transa\xe7\xe3o",level:3},{value:"Contextos de Importa\xe7\xe3o",id:"contextos-de-importa\xe7\xe3o",level:2},{value:"Contexto de Cart\xe3o (<code>card_id</code>)",id:"contexto-de-cart\xe3o-card_id",level:3},{value:"Contexto de Conta (<code>account_id</code>)",id:"contexto-de-conta-account_id",level:3},{value:"Campo <code>data</code> (JSON)",id:"campo-data-json",level:2},{value:"Status das Staged Transactions",id:"status-das-staged-transactions",level:2},{value:"Fluxo de Vida da Sess\xe3o",id:"fluxo-de-vida-da-sess\xe3o",level:2},{value:"1. Criar Sess\xe3o",id:"1-criar-sess\xe3o",level:3},{value:"2. Adicionar Transa\xe7\xf5es (Staged Transactions)",id:"2-adicionar-transa\xe7\xf5es-staged-transactions",level:3},{value:"A. Upload de Arquivo CSV",id:"a-upload-de-arquivo-csv",level:4},{value:"B. Cria\xe7\xe3o Manual (Lote)",id:"b-cria\xe7\xe3o-manual-lote",level:4},{value:"3. Revisar e Enriquecer",id:"3-revisar-e-enriquecer",level:3},{value:"4. Commit Session",id:"4-commit-session",level:3},{value:"5. Close Session (Concilia\xe7\xe3o)",id:"5-close-session-concilia\xe7\xe3o",level:3},{value:"Vincula\xe7\xe3o com Transa\xe7\xf5es Recorrentes",id:"vincula\xe7\xe3o-com-transa\xe7\xf5es-recorrentes",level:2},{value:"Como funciona",id:"como-funciona",level:3},{value:"Campos herdados",id:"campos-herdados",level:3},{value:"Campos salvos no JSON <code>data</code>",id:"campos-salvos-no-json-data",level:3},{value:"Exemplo",id:"exemplo",level:3},{value:"Detalhes da Sess\xe3o (Get Session)",id:"detalhes-da-sess\xe3o-get-session",level:2},{value:"C\xe1lculo do <code>initial_balance</code>",id:"c\xe1lculo-do-initial_balance",level:3},{value:"Contexto de Conta",id:"contexto-de-conta",level:4},{value:"Contexto de Cart\xe3o",id:"contexto-de-cart\xe3o",level:4},{value:"C\xe1lculo do <code>context_value</code>",id:"c\xe1lculo-do-context_value",level:3},{value:"Contexto de Conta",id:"contexto-de-conta-1",level:4},{value:"Contexto de Cart\xe3o",id:"contexto-de-cart\xe3o-1",level:4},{value:"Concilia\xe7\xe3o",id:"concilia\xe7\xe3o",level:3},{value:"Entidades do Banco de Dados",id:"entidades-do-banco-de-dados",level:2},{value:"ImportSession",id:"importsession",level:3},{value:"StagedTransaction",id:"stagedtransaction",level:3},{value:"Resumo dos Endpoints",id:"resumo-dos-endpoints",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"sess\xe3o-de-importa\xe7\xe3o-import-session",children:"Sess\xe3o de Importa\xe7\xe3o (Import Session)"})}),"\n",(0,r.jsxs)(s.p,{children:["A ",(0,r.jsx)(s.strong,{children:"Sess\xe3o de Importa\xe7\xe3o"})," \xe9 uma funcionalidade central do FinTrack que permite importar, revisar e categorizar transa\xe7\xf5es em uma \xe1rea de staging segura antes de afetar os saldos oficiais das contas ou cart\xf5es."]}),"\n",(0,r.jsx)(s.h2,{id:"conceito",children:"Conceito"}),"\n",(0,r.jsxs)(s.p,{children:["Uma ",(0,r.jsx)(s.strong,{children:"Session"})," funciona como uma \xe1rea de staging atrelada a um ",(0,r.jsx)(s.strong,{children:"Workspace"}),". Nela, voc\xea pode manipular transa\xe7\xf5es livremente sem impactar o saldo final das contas ou as tabelas principais do banco de dados."]}),"\n",(0,r.jsx)(s.h3,{id:"informa\xe7\xf5es-principais-de-uma-transa\xe7\xe3o",children:"Informa\xe7\xf5es Principais de uma Transa\xe7\xe3o"}),"\n",(0,r.jsx)(s.p,{children:"Cada transa\xe7\xe3o possui tr\xeas informa\xe7\xf5es essenciais:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"transaction_date"})}),": Data da transa\xe7\xe3o"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"description"})}),": Descri\xe7\xe3o da transa\xe7\xe3o"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"amount"})}),": Valor da transa\xe7\xe3o"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"contextos-de-importa\xe7\xe3o",children:"Contextos de Importa\xe7\xe3o"}),"\n",(0,r.jsxs)(s.p,{children:["Cada sess\xe3o pode ter dois tipos de contexto, sendo ",(0,r.jsx)(s.strong,{children:"obrigat\xf3rio"})," informar o ",(0,r.jsx)(s.code,{children:"billing_month"})," referente ao m\xeas ou fatura:"]}),"\n",(0,r.jsxs)(s.h3,{id:"contexto-de-cart\xe3o-card_id",children:["Contexto de Cart\xe3o (",(0,r.jsx)(s.code,{children:"card_id"}),")"]}),"\n",(0,r.jsx)(s.p,{children:"Para importa\xe7\xe3o de despesas de cart\xe3o de cr\xe9dito ou lan\xe7amentos de estorno na fatura."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Tipos de transa\xe7\xe3o dispon\xedveis:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tipo"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_EXPENSE"})}),(0,r.jsx)(s.td,{children:"Despesa de cart\xe3o (valor positivo)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_CHARGEBACK"})}),(0,r.jsx)(s.td,{children:"Estorno de cart\xe3o (valor negativo)"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["As despesas podem ser vinculadas a transa\xe7\xf5es recorrentes da tabela de ",(0,r.jsx)(s.strong,{children:"Recurring Card Expenses"}),"."]}),"\n",(0,r.jsxs)(s.h3,{id:"contexto-de-conta-account_id",children:["Contexto de Conta (",(0,r.jsx)(s.code,{children:"account_id"}),")"]}),"\n",(0,r.jsx)(s.p,{children:"Para importa\xe7\xe3o de transa\xe7\xf5es de conta corrente, poupan\xe7a e outros."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Tipos de transa\xe7\xe3o dispon\xedveis:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tipo"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INCOME"})}),(0,r.jsx)(s.td,{children:"Receita (valor positivo)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"EXPENSE"})}),(0,r.jsx)(s.td,{children:"Despesa (valor negativo)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TRANSFER"})}),(0,r.jsx)(s.td,{children:"Transfer\xeancia entre contas"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_PAYMENT"})}),(0,r.jsx)(s.td,{children:"Pagamento de fatura de cart\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INVESTMENT_DEPOSIT"})}),(0,r.jsx)(s.td,{children:"Dep\xf3sito em investimentos"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INVESTMENT_WITHDRAWAL"})}),(0,r.jsx)(s.td,{children:"Saque de investimentos"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["As transa\xe7\xf5es podem ser vinculadas a ",(0,r.jsx)(s.strong,{children:"Recurring Incomes"}),", ",(0,r.jsx)(s.strong,{children:"Recurring Expenses"})," e ",(0,r.jsx)(s.strong,{children:"Recurring Transfers"}),"."]}),"\n",(0,r.jsxs)(s.h2,{id:"campo-data-json",children:["Campo ",(0,r.jsx)(s.code,{children:"data"})," (JSON)"]}),"\n",(0,r.jsxs)(s.p,{children:["Cada tipo de transa\xe7\xe3o requer campos espec\xedficos para ser salva no banco final. O campo ",(0,r.jsx)(s.code,{children:"data"})," (tipo JSONB) armazena os atributos necess\xe1rios para cada tipo de transa\xe7\xe3o, como:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"IDs de categoria e subcategoria"}),"\n",(0,r.jsx)(s.li,{children:"Conta de destino (para transfer\xeancias)"}),"\n",(0,r.jsx)(s.li,{children:"ID da transa\xe7\xe3o recorrente vinculada"}),"\n",(0,r.jsxs)(s.li,{children:["Flag ",(0,r.jsx)(s.code,{children:"ignore: true"})," para transa\xe7\xf5es que devem ser ignoradas"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"status-das-staged-transactions",children:"Status das Staged Transactions"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Status"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"READY"})}),(0,r.jsx)(s.td,{children:"Transa\xe7\xe3o possui todas as informa\xe7\xf5es necess\xe1rias para ser salva na base"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"PENDING"})}),(0,r.jsx)(s.td,{children:"Faltam informa\xe7\xf5es obrigat\xf3rias para salvar na base"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"PROCESSING"})}),(0,r.jsx)(s.td,{children:"Transa\xe7\xe3o est\xe1 sendo processada pela IA para categoriza\xe7\xe3o"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"fluxo-de-vida-da-sess\xe3o",children:"Fluxo de Vida da Sess\xe3o"}),"\n",(0,r.jsx)(s.mermaid,{value:"graph TD\n    A[1. Criar Sess\xe3o] --\x3e B[2. Adicionar Transa\xe7\xf5es]\n    B --\x3e C[3. Revisar e Enriquecer]\n    C --\x3e D{Todas READY?}\n    D --\x3e|N\xe3o| C\n    D --\x3e|Sim| E[4. Commit Session]\n    E --\x3e F[5. Close Session]\n    F --\x3e G[Sess\xe3o Exclu\xedda]"}),"\n",(0,r.jsx)(s.h3,{id:"1-criar-sess\xe3o",children:"1. Criar Sess\xe3o"}),"\n",(0,r.jsxs)(s.p,{children:["Cria uma nova sess\xe3o de importa\xe7\xe3o vinculada ao workspace (obtido do header ",(0,r.jsx)(s.code,{children:"x-workspace-id"}),")."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Requisitos:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Informar ",(0,r.jsx)(s.code,{children:"account_id"})," OU ",(0,r.jsx)(s.code,{children:"card_id"})]}),"\n",(0,r.jsxs)(s.li,{children:["Informar ",(0,r.jsx)(s.code,{children:"billing_month"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"target_value"})," \xe9 opcional (default: 0)"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Para contexto de cart\xe3o:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["O ",(0,r.jsx)(s.code,{children:"target_value"})," padr\xe3o deve ser a soma dos pagamentos de cart\xe3o para o ",(0,r.jsx)(s.code,{children:"card_id"})," e ",(0,r.jsx)(s.code,{children:"billing_month"})," consultados no banco"]}),"\n",(0,r.jsxs)(s.li,{children:["Valida se a fatura existe e est\xe1 no status ",(0,r.jsx)(s.code,{children:"OPEN"})]}),"\n",(0,r.jsxs)(s.li,{children:["Se n\xe3o existir, a fatura \xe9 criada com status ",(0,r.jsx)(s.code,{children:"OPEN"})]}),"\n",(0,r.jsx)(s.li,{children:"Se existir em outro status, retorna erro 400"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Nome da Sess\xe3o:"}),"\nO nome \xe9 gerado automaticamente: ",(0,r.jsx)(s.code,{children:"{Nome da Conta/Cart\xe3o} | {billing_month}"})]}),"\n",(0,r.jsx)(s.h3,{id:"2-adicionar-transa\xe7\xf5es-staged-transactions",children:"2. Adicionar Transa\xe7\xf5es (Staged Transactions)"}),"\n",(0,r.jsx)(s.p,{children:"H\xe1 duas formas de popular a sess\xe3o de importa\xe7\xe3o:"}),"\n",(0,r.jsx)(s.h4,{id:"a-upload-de-arquivo-csv",children:"A. Upload de Arquivo CSV"}),"\n",(0,r.jsx)(s.p,{children:"\xc9 poss\xedvel fazer o upload de um arquivo CSV contendo o extrato banc\xe1rio ou fatura do cart\xe3o. O sistema processa o arquivo e cria automaticamente as staged transactions."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Endpoint:"})," ",(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/upload"})]}),"\n",(0,r.jsx)(s.h4,{id:"b-cria\xe7\xe3o-manual-lote",children:"B. Cria\xe7\xe3o Manual (Lote)"}),"\n",(0,r.jsxs)(s.p,{children:["Voc\xea pode criar transa\xe7\xf5es manualmente informando ",(0,r.jsx)(s.code,{children:"transaction_date"}),", ",(0,r.jsx)(s.code,{children:"description"})," e ",(0,r.jsx)(s.code,{children:"amount"}),"."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Regra de sinais:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Contexto"}),(0,r.jsx)(s.th,{children:"Valor Positivo"}),(0,r.jsx)(s.th,{children:"Valor Negativo"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Conta"}),(0,r.jsxs)(s.td,{children:["Receita (",(0,r.jsx)(s.code,{children:"INCOME"}),")"]}),(0,r.jsxs)(s.td,{children:["Despesa (",(0,r.jsx)(s.code,{children:"EXPENSE"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Cart\xe3o"}),(0,r.jsxs)(s.td,{children:["Despesa (",(0,r.jsx)(s.code,{children:"CARD_EXPENSE"}),")"]}),(0,r.jsxs)(s.td,{children:["Estorno (",(0,r.jsx)(s.code,{children:"CARD_CHARGEBACK"}),")"]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"3-revisar-e-enriquecer",children:"3. Revisar e Enriquecer"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Atualizar transa\xe7\xf5es individualmente"}),"\n",(0,r.jsx)(s.li,{children:"Alterar tipos, categorias e subcategorias"}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Adicionar Tags:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Vincular tags existentes (",(0,r.jsx)(s.code,{children:"tag_ids"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["Criar novas tags informando o nome (",(0,r.jsx)(s.code,{children:"tags"}),") - elas ser\xe3o criadas automaticamente no workspace"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.li,{children:"Vincular a transa\xe7\xf5es recorrentes (recurring transactions)"}),"\n",(0,r.jsxs)(s.li,{children:["Aguardar processamento da IA (status ",(0,r.jsx)(s.code,{children:"PROCESSING"})," \u2192 ",(0,r.jsx)(s.code,{children:"READY"}),")"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"4-commit-session",children:"4. Commit Session"}),"\n",(0,r.jsxs)(s.p,{children:["Salva todas as transa\xe7\xf5es com status ",(0,r.jsx)(s.code,{children:"READY"})," nas tabelas principais do banco de dados:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es s\xe3o salvas com status ",(0,r.jsx)(s.code,{children:"VALIDATING"})]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es com ",(0,r.jsx)(s.code,{children:"ignore: true"})," no JSON s\xe3o salvas com status ",(0,r.jsx)(s.code,{children:"IGNORE"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"5-close-session-concilia\xe7\xe3o",children:"5. Close Session (Concilia\xe7\xe3o)"}),"\n",(0,r.jsx)(s.p,{children:"Etapa final e irrevers\xedvel que:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Para Contexto de Conta:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Altera o status de todas as transa\xe7\xf5es da conta de ",(0,r.jsx)(s.code,{children:"VALIDATING"})," para ",(0,r.jsx)(s.code,{children:"PAID"})]}),"\n",(0,r.jsx)(s.li,{children:"Exclui a sess\xe3o e todas as staged transactions"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Para Contexto de Cart\xe3o:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Altera o status das transa\xe7\xf5es do cart\xe3o de ",(0,r.jsx)(s.code,{children:"VALIDATING"})," para ",(0,r.jsx)(s.code,{children:"PAID"})]}),"\n",(0,r.jsxs)(s.li,{children:["Altera o status da fatura para ",(0,r.jsx)(s.code,{children:"PAID"})]}),"\n",(0,r.jsx)(s.li,{children:"Exclui a sess\xe3o e todas as staged transactions"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"vincula\xe7\xe3o-com-transa\xe7\xf5es-recorrentes",children:"Vincula\xe7\xe3o com Transa\xe7\xf5es Recorrentes"}),"\n",(0,r.jsx)(s.p,{children:"Uma staged transaction pode ser vinculada a uma transa\xe7\xe3o recorrente (recurring) para herdar automaticamente suas configura\xe7\xf5es."}),"\n",(0,r.jsx)(s.h3,{id:"como-funciona",children:"Como funciona"}),"\n",(0,r.jsx)(s.p,{children:"O endpoint de bind recebe:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"staged_transaction_id"}),": ID da staged transaction a ser vinculada"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"recurring_transaction_id"}),": ID da transa\xe7\xe3o recorrente"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"O sistema identifica o tipo de recurring transaction consultando as tabelas na seguinte ordem:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tabela"}),(0,r.jsx)(s.th,{children:"Tipo"}),(0,r.jsx)(s.th,{children:"Contexto"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_incomes"})}),(0,r.jsx)(s.td,{children:"Receita recorrente"}),(0,r.jsx)(s.td,{children:"Conta"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_expenses"})}),(0,r.jsx)(s.td,{children:"Despesa recorrente"}),(0,r.jsx)(s.td,{children:"Conta"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_transfers"})}),(0,r.jsx)(s.td,{children:"Transfer\xeancia recorrente"}),(0,r.jsx)(s.td,{children:"Conta"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_card_transactions"})}),(0,r.jsx)(s.td,{children:"Despesa de cart\xe3o recorrente"}),(0,r.jsx)(s.td,{children:"Cart\xe3o"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"campos-herdados",children:"Campos herdados"}),"\n",(0,r.jsx)(s.p,{children:"Ao vincular, a staged transaction assume automaticamente:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Campo"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"type"})}),(0,r.jsx)(s.td,{children:"Tipo da transa\xe7\xe3o (INCOME, EXPENSE, TRANSFER, CARD_EXPENSE)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"description"})}),(0,r.jsx)(s.td,{children:"Descri\xe7\xe3o da recorrente"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"category_id"})}),(0,r.jsx)(s.td,{children:"Categoria da recorrente"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"subcategory_id"})}),(0,r.jsx)(s.td,{children:"Subcategoria (se existir na recorrente)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_*_id"})}),(0,r.jsx)(s.td,{children:"ID da recorrente vinculada"})]})]})]}),"\n",(0,r.jsxs)(s.h3,{id:"campos-salvos-no-json-data",children:["Campos salvos no JSON ",(0,r.jsx)(s.code,{children:"data"})]}),"\n",(0,r.jsxs)(s.p,{children:["Dependendo do tipo de recurring, o campo correspondente \xe9 adicionado ao JSON ",(0,r.jsx)(s.code,{children:"data"}),":"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tipo de Recurring"}),(0,r.jsx)(s.th,{children:"Campo no JSON"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Recurring Income"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_income_id"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Recurring Expense"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_expense_id"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Recurring Transfer"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_transfer_id"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Recurring Card Transaction"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"recurring_card_transaction_id"})})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"exemplo",children:"Exemplo"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Antes do bind:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-staged",\n  "type": "EXPENSE",\n  "status": "PENDING",\n  "amount": 49.90,\n  "data": {\n    "description": "NETFLIX"\n  }\n}\n'})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Request de bind:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "staged_transaction_id": "uuid-staged",\n  "recurring_transaction_id": "uuid-recurring-netflix"\n}\n'})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Ap\xf3s o bind:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-staged",\n  "type": "EXPENSE",\n  "status": "READY",\n  "amount": 49.90,\n  "data": {\n    "description": "Netflix - Assinatura Mensal",\n    "category_id": "uuid-categoria-streaming",\n    "subcategory_id": "uuid-subcategoria-video",\n    "recurring_expense_id": "uuid-recurring-netflix"\n  }\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:["O status muda para ",(0,r.jsx)(s.code,{children:"READY"})," pois agora a transa\xe7\xe3o possui todos os campos obrigat\xf3rios."]}),"\n",(0,r.jsx)(s.h2,{id:"detalhes-da-sess\xe3o-get-session",children:"Detalhes da Sess\xe3o (Get Session)"}),"\n",(0,r.jsx)(s.p,{children:"Ao consultar uma sess\xe3o, s\xe3o retornadas as seguintes informa\xe7\xf5es:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Campo"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"name"})}),(0,r.jsx)(s.td,{children:"Nome da sess\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"type"})}),(0,r.jsx)(s.td,{children:"Tipo (conta ou cart\xe3o)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"target_value"})}),(0,r.jsx)(s.td,{children:"Valor alvo para concilia\xe7\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"initial_balance"})}),(0,r.jsx)(s.td,{children:"Saldo no in\xedcio do m\xeas"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"context_value"})}),(0,r.jsx)(s.td,{children:"Saldo atual calculado"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"transactions"})}),(0,r.jsx)(s.td,{children:"Lista de todas as transa\xe7\xf5es da sess\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"stats"})}),(0,r.jsxs)(s.td,{children:["Contagem de transa\xe7\xf5es ",(0,r.jsx)(s.code,{children:"READY"})," vs total"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"status"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"OK"})," se todas est\xe3o ",(0,r.jsx)(s.code,{children:"READY"})," e ",(0,r.jsx)(s.code,{children:"target_value == context_value"})," (n\xe3o impeditivo)"]})]})]})]}),"\n",(0,r.jsxs)(s.h3,{id:"c\xe1lculo-do-initial_balance",children:["C\xe1lculo do ",(0,r.jsx)(s.code,{children:"initial_balance"})]}),"\n",(0,r.jsx)(s.h4,{id:"contexto-de-conta",children:"Contexto de Conta"}),"\n",(0,r.jsxs)(s.p,{children:["O ",(0,r.jsx)(s.code,{children:"initial_balance"})," representa o saldo da conta no ",(0,r.jsx)(s.strong,{children:"in\xedcio do m\xeas"})," especificado no ",(0,r.jsx)(s.code,{children:"billing_month"}),"."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"F\xf3rmula:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"initial_balance = Soma de todas as transa\xe7\xf5es da conta com data < primeiro dia do billing_month\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Tabelas consultadas:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tabela"}),(0,r.jsx)(s.th,{children:"Opera\xe7\xe3o"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"incomes"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})}),(0,r.jsx)(s.td,{children:"Receitas somam ao saldo"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"expenses"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})}),(0,r.jsx)(s.td,{children:"Despesas subtraem do saldo"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"transfers"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"- amount"})," (source)"]}),(0,r.jsx)(s.td,{children:"Transfer\xeancias enviadas subtraem"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"transfers"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"+ amount"})," (destination)"]}),(0,r.jsx)(s.td,{children:"Transfer\xeancias recebidas somam"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"card_payments"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})}),(0,r.jsx)(s.td,{children:"Pagamentos de cart\xe3o subtraem"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"investment_deposits"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})}),(0,r.jsx)(s.td,{children:"Dep\xf3sitos em investimento subtraem"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"investment_withdrawals"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})}),(0,r.jsx)(s.td,{children:"Saques de investimento somam"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Exemplo:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"billing_month"}),": ",(0,r.jsx)(s.code,{children:"2024-03"})]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es da conta antes de 01/03/2024:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"15/01/2024: +1000.00 (income)"}),"\n",(0,r.jsx)(s.li,{children:"20/01/2024: -200.00 (expense)"}),"\n",(0,r.jsx)(s.li,{children:"10/02/2024: +500.00 (income)"}),"\n",(0,r.jsx)(s.li,{children:"25/02/2024: -150.00 (expense)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"initial_balance"})," = 1000 - 200 + 500 - 150 = ",(0,r.jsx)(s.strong,{children:"R$ 1.150,00"})]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"contexto-de-cart\xe3o",children:"Contexto de Cart\xe3o"}),"\n",(0,r.jsxs)(s.p,{children:["O ",(0,r.jsx)(s.code,{children:"initial_balance"})," representa o valor da fatura ",(0,r.jsx)(s.strong,{children:"sem"})," as staged transactions."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"F\xf3rmula:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"initial_balance = card_expenses - card_chargebacks\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Tabelas consultadas:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tabela"}),(0,r.jsx)(s.th,{children:"Opera\xe7\xe3o"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"card_expenses"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})}),(0,r.jsx)(s.td,{children:"Despesas somam \xe0 fatura"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"card_chargebacks"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})}),(0,r.jsx)(s.td,{children:"Estornos subtraem da fatura"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Exemplo:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"billing_month"}),": ",(0,r.jsx)(s.code,{children:"2024-03"}),", ",(0,r.jsx)(s.code,{children:"card_id"}),": ",(0,r.jsx)(s.code,{children:"uuid-cartao"})]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es j\xe1 registradas na fatura:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"05/03/2024: +500.00 (card_expense)"}),"\n",(0,r.jsx)(s.li,{children:"10/03/2024: +200.00 (card_expense)"}),"\n",(0,r.jsx)(s.li,{children:"15/03/2024: -50.00 (card_chargeback)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"initial_balance"})," = 500 + 200 - 50 = ",(0,r.jsx)(s.strong,{children:"R$ 650,00"})]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"c\xe1lculo-do-context_value",children:["C\xe1lculo do ",(0,r.jsx)(s.code,{children:"context_value"})]}),"\n",(0,r.jsx)(s.h4,{id:"contexto-de-conta-1",children:"Contexto de Conta"}),"\n",(0,r.jsxs)(s.p,{children:["O ",(0,r.jsx)(s.code,{children:"context_value"})," representa o saldo ",(0,r.jsx)(s.strong,{children:"atual"})," da conta, incluindo todas as transa\xe7\xf5es j\xe1 registradas at\xe9 a data atual mais as transa\xe7\xf5es da sess\xe3o de importa\xe7\xe3o."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"F\xf3rmula:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"context_value = initial_balance\n              + transa\xe7\xf5es do m\xeas nas tabelas principais\n              + staged_transactions da sess\xe3o\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Regra de sinais para Staged Transactions:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tipo"}),(0,r.jsx)(s.th,{children:"Opera\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INCOME"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"EXPENSE"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TRANSFER"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"- amount"})," (source) / ",(0,r.jsx)(s.code,{children:"+ amount"})," (destination)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_PAYMENT"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INVESTMENT_DEPOSIT"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INVESTMENT_WITHDRAWAL"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Exemplo (continuando o anterior):"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"initial_balance"}),": R$ 1.150,00"]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es j\xe1 registradas em mar\xe7o/2024 (tabelas principais):","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"05/03/2024: +2000.00 (income)"}),"\n",(0,r.jsx)(s.li,{children:"10/03/2024: -300.00 (expense)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es na sess\xe3o de importa\xe7\xe3o (staged_transactions):","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"15/03/2024: -100.00 (EXPENSE)"}),"\n",(0,r.jsx)(s.li,{children:"20/03/2024: -50.00 (EXPENSE)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"context_value"})," = 1150 + 2000 - 300 - 100 - 50 = ",(0,r.jsx)(s.strong,{children:"R$ 2.700,00"})]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"contexto-de-cart\xe3o-1",children:"Contexto de Cart\xe3o"}),"\n",(0,r.jsxs)(s.p,{children:["O ",(0,r.jsx)(s.code,{children:"context_value"})," representa o valor total da fatura incluindo as staged transactions."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"F\xf3rmula:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"context_value = initial_balance + staged_transactions da sess\xe3o\n"})}),"\n",(0,r.jsx)(s.p,{children:"Ou seja:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"context_value = (card_expenses - card_chargebacks) + staged_transactions\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Regra de sinais para Staged Transactions:"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tipo"}),(0,r.jsx)(s.th,{children:"Opera\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_EXPENSE"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"+ amount"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"CARD_CHARGEBACK"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"- amount"})})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Exemplo (continuando o anterior):"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"initial_balance"}),": R$ 650,00"]}),"\n",(0,r.jsxs)(s.li,{children:["Transa\xe7\xf5es na sess\xe3o de importa\xe7\xe3o (staged_transactions):","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"18/03/2024: +150.00 (CARD_EXPENSE)"}),"\n",(0,r.jsx)(s.li,{children:"22/03/2024: +80.00 (CARD_EXPENSE)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"context_value"})," = 650 + 150 + 80 = ",(0,r.jsx)(s.strong,{children:"R$ 880,00"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"concilia\xe7\xe3o",children:"Concilia\xe7\xe3o"}),"\n",(0,r.jsx)(s.p,{children:"A concilia\xe7\xe3o \xe9 considerada bem-sucedida quando:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"target_value == context_value\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Isso indica que o saldo calculado pelo sistema corresponde ao saldo esperado (extrato banc\xe1rio). Essa valida\xe7\xe3o ",(0,r.jsx)(s.strong,{children:"n\xe3o \xe9 impeditiva"})," para fechar a sess\xe3o, servindo apenas como indicador para o usu\xe1rio."]}),"\n",(0,r.jsx)(s.h2,{id:"entidades-do-banco-de-dados",children:"Entidades do Banco de Dados"}),"\n",(0,r.jsx)(s.h3,{id:"importsession",children:"ImportSession"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"interface ImportSession {\n  id: uuid;              // Identificador \xfanico\n  workspace_id: uuid;    // Workspace ao qual pertence\n  user_id: uuid;         // Usu\xe1rio que criou\n  description: string;   // Nome da sess\xe3o\n  account_id?: uuid;     // ID da conta (se contexto de conta)\n  card_id?: uuid;        // ID do cart\xe3o (se contexto de cart\xe3o)\n  billing_month: string; // M\xeas de refer\xeancia (YYYY-MM)\n  target_value: number;  // Valor alvo para concilia\xe7\xe3o\n  created_at: timestamp; // Data de cria\xe7\xe3o\n}\n"})}),"\n",(0,r.jsx)(s.h3,{id:"stagedtransaction",children:"StagedTransaction"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"interface StagedTransaction {\n  id: uuid;                    // Identificador \xfanico\n  session_id: uuid;            // ID da sess\xe3o pai\n  type: StagedTransactionType; // Tipo da transa\xe7\xe3o\n  status: StagedTransactionStatus; // Status atual\n  transaction_date: date;      // Data da transa\xe7\xe3o\n  amount: number;              // Valor\n  data: jsonb;                 // Metadados adicionais\n  line_number: number;         // N\xfamero da linha do arquivo importado\n}\n"})}),"\n",(0,r.jsx)(s.h2,{id:"resumo-dos-endpoints",children:"Resumo dos Endpoints"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Opera\xe7\xe3o"}),(0,r.jsx)(s.th,{children:"Endpoint"}),(0,r.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Criar Sess\xe3o"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions"})}),(0,r.jsx)(s.td,{children:"Cria nova sess\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Listar Sess\xf5es"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET /import-sessions"})}),(0,r.jsx)(s.td,{children:"Lista sess\xf5es do workspace"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Obter Sess\xe3o"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET /import-sessions/:id"})}),(0,r.jsx)(s.td,{children:"Detalhes da sess\xe3o com contexto"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Excluir Sess\xe3o"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"DELETE /import-sessions/:id"})}),(0,r.jsx)(s.td,{children:"Remove sess\xe3o e transa\xe7\xf5es"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Upload CSV"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/upload"})}),(0,r.jsx)(s.td,{children:"Importa transa\xe7\xf5es via CSV"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Criar Transa\xe7\xf5es"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/staged-transactions"})}),(0,r.jsx)(s.td,{children:"Cria transa\xe7\xf5es em lote"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Excluir Todas"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"DELETE /import-sessions/:id/staged-transactions"})}),(0,r.jsx)(s.td,{children:"Remove todas as transa\xe7\xf5es"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Commit"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/commit"})}),(0,r.jsx)(s.td,{children:"Efetiva transa\xe7\xf5es"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Close"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/close"})}),(0,r.jsx)(s.td,{children:"Concilia e encerra"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Vincular Recorrente"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST /import-sessions/:id/bind"})}),(0,r.jsx)(s.td,{children:"Vincula a recurring"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Obter Transa\xe7\xe3o"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET /staged-transactions/:id"})}),(0,r.jsx)(s.td,{children:"Detalhes da transa\xe7\xe3o"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Atualizar Transa\xe7\xe3o"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"PUT /staged-transactions/:id"})}),(0,r.jsx)(s.td,{children:"Atualiza transa\xe7\xe3o"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["Para detalhes t\xe9cnicos dos endpoints, consulte a ",(0,r.jsx)(s.a,{href:"/docs/api-reference/import-sessions",children:"API Reference"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,s,n){n.d(s,{R:()=>a,x:()=>c});var d=n(6540);const r={},i=d.createContext(r);function a(e){const s=d.useContext(i);return d.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),d.createElement(i.Provider,{value:s},e.children)}}}]);