"use strict";(globalThis.webpackChunkgh_docs=globalThis.webpackChunkgh_docs||[]).push([[6226],{1981(e,s,n){n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"api-reference/import-sessions","title":"Import Sessions API","description":"Refer\xeancia completa da API de Import Sessions","source":"@site/docs/api-reference/import-sessions.md","sourceDirName":"api-reference","slug":"/api-reference/import-sessions","permalink":"/fintrack-docs/docs/api-reference/import-sessions","draft":false,"unlisted":false,"editUrl":"https://github.com/PHRaulino-Space/fintrack-docs/tree/main/gh-docs/docs/api-reference/import-sessions.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Import Sessions API","description":"Refer\xeancia completa da API de Import Sessions"},"sidebar":"tutorialSidebar","previous":{"title":"Transactions","permalink":"/fintrack-docs/docs/api-reference/transactions"},"next":{"title":"Recurring Transactions API","permalink":"/fintrack-docs/docs/api-reference/recurring-transactions"}}');var d=n(4848),i=n(8453);const c={sidebar_position:7,title:"Import Sessions API",description:"Refer\xeancia completa da API de Import Sessions"},a="Import Sessions API",t={},o=[{value:"Endpoints da Sess\xe3o",id:"endpoints-da-sess\xe3o",level:2},{value:"Criar Sess\xe3o",id:"criar-sess\xe3o",level:3},{value:"Listar Sess\xf5es",id:"listar-sess\xf5es",level:3},{value:"Obter Sess\xe3o",id:"obter-sess\xe3o",level:3},{value:"Excluir Sess\xe3o",id:"excluir-sess\xe3o",level:3},{value:"Commit Session",id:"commit-session",level:3},{value:"Close Session",id:"close-session",level:3},{value:"Vincular Transa\xe7\xe3o Recorrente",id:"vincular-transa\xe7\xe3o-recorrente",level:3},{value:"Endpoints de Staged Transactions",id:"endpoints-de-staged-transactions",level:2},{value:"Criar Transa\xe7\xf5es",id:"criar-transa\xe7\xf5es",level:3},{value:"Excluir Todas as Transa\xe7\xf5es",id:"excluir-todas-as-transa\xe7\xf5es",level:3},{value:"Obter Transa\xe7\xe3o",id:"obter-transa\xe7\xe3o",level:3},{value:"Atualizar Transa\xe7\xe3o",id:"atualizar-transa\xe7\xe3o",level:3},{value:"Tipos e Enums",id:"tipos-e-enums",level:2},{value:"StagedTransactionType",id:"stagedtransactiontype",level:3},{value:"StagedTransactionStatus",id:"stagedtransactionstatus",level:3},{value:"C\xf3digos de Erro",id:"c\xf3digos-de-erro",level:2}];function l(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.header,{children:(0,d.jsx)(s.h1,{id:"import-sessions-api",children:"Import Sessions API"})}),"\n",(0,d.jsx)(s.p,{children:"API para gerenciamento do ciclo de vida de importa\xe7\xe3o de transa\xe7\xf5es."}),"\n",(0,d.jsx)(s.h2,{id:"endpoints-da-sess\xe3o",children:"Endpoints da Sess\xe3o"}),"\n",(0,d.jsx)(s.h3,{id:"criar-sess\xe3o",children:"Criar Sess\xe3o"}),"\n",(0,d.jsx)(s.p,{children:"Cria uma nova sess\xe3o de importa\xe7\xe3o vinculada ao workspace."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"POST /import-sessions\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Headers:"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"x-workspace-id"}),": UUID do workspace (obrigat\xf3rio)"]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"Authorization"}),": Bearer token"]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "account_id": "uuid-da-conta",       // Contexto de conta\n  "card_id": "uuid-do-cartao",         // Contexto de cart\xe3o\n  "billing_month": "2024-01",          // M\xeas de refer\xeancia (YYYY-MM)\n  "target_value": 1500.00              // Opcional, default: 0\n}\n'})}),"\n",(0,d.jsx)(s.admonition,{title:"Regras de Cria\xe7\xe3o",type:"info",children:(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Deve informar ",(0,d.jsx)(s.code,{children:"account_id"})," ",(0,d.jsx)(s.strong,{children:"OU"})," ",(0,d.jsx)(s.code,{children:"card_id"})," (n\xe3o ambos)"]}),"\n",(0,d.jsxs)(s.li,{children:["O ",(0,d.jsx)(s.code,{children:"billing_month"})," \xe9 obrigat\xf3rio"]}),"\n",(0,d.jsxs)(s.li,{children:["Para contexto de cart\xe3o, o ",(0,d.jsx)(s.code,{children:"target_value"})," padr\xe3o \xe9 a soma dos pagamentos do cart\xe3o para aquele m\xeas"]}),"\n",(0,d.jsxs)(s.li,{children:["A fatura do cart\xe3o deve estar com status ",(0,d.jsx)(s.code,{children:"OPEN"})," ou ser\xe1 criada automaticamente"]}),"\n",(0,d.jsxs)(s.li,{children:["Se a fatura existir em status diferente de ",(0,d.jsx)(s.code,{children:"OPEN"}),", retorna erro 400"]}),"\n"]})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (201 Created):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-da-sessao",\n  "workspace_id": "uuid-workspace",\n  "user_id": "uuid-usuario",\n  "description": "Nubank | 2024-01",\n  "account_id": null,\n  "card_id": "uuid-cartao",\n  "billing_month": "2024-01",\n  "target_value": 1500.00,\n  "created_at": "2024-01-15T10:30:00Z"\n}\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"listar-sess\xf5es",children:"Listar Sess\xf5es"}),"\n",(0,d.jsx)(s.p,{children:"Lista todas as sess\xf5es de importa\xe7\xe3o do workspace."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"GET /import-sessions\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'[\n  {\n    "id": "uuid-sessao-1",\n    "description": "Nubank | 2024-01",\n    "type": "card",\n    "target_value": 1500.00,\n    "stats": {\n      "ready": 40,\n      "total": 45\n    }\n  }\n]\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"obter-sess\xe3o",children:"Obter Sess\xe3o"}),"\n",(0,d.jsx)(s.p,{children:"Retorna detalhes completos de uma sess\xe3o com contexto para ajudar o usu\xe1rio."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"GET /import-sessions/:id\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-sessao",\n  "description": "Nubank | 2024-01",\n  "type": "card",\n  "target_value": 1500.00,\n  "initial_balance": 0,\n  "context_value": 1450.00,\n  "stats": {\n    "ready": 40,\n    "total": 45\n  },\n  "status": "pending",\n  "transactions": [...]\n}\n'})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Campo"}),(0,d.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"name"})}),(0,d.jsx)(s.td,{children:"Nome da sess\xe3o"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"type"})}),(0,d.jsx)(s.td,{children:"Tipo (conta ou cart\xe3o)"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"target_value"})}),(0,d.jsx)(s.td,{children:"Valor alvo para concilia\xe7\xe3o"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"initial_balance"})}),(0,d.jsx)(s.td,{children:"Saldo no in\xedcio do m\xeas (ver c\xe1lculo abaixo)"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"context_value"})}),(0,d.jsx)(s.td,{children:"Saldo atual calculado (ver c\xe1lculo abaixo)"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"transactions"})}),(0,d.jsx)(s.td,{children:"Lista de todas as transa\xe7\xf5es da sess\xe3o"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"stats"})}),(0,d.jsxs)(s.td,{children:["Contagem de transa\xe7\xf5es ",(0,d.jsx)(s.code,{children:"ready"})," vs ",(0,d.jsx)(s.code,{children:"total"})]})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"status"})}),(0,d.jsxs)(s.td,{children:[(0,d.jsx)(s.code,{children:"ok"})," se todas ",(0,d.jsx)(s.code,{children:"READY"})," e ",(0,d.jsx)(s.code,{children:"target_value == context_value"})," (n\xe3o impeditivo)"]})]})]})]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsxs)(s.strong,{children:["C\xe1lculo do ",(0,d.jsx)(s.code,{children:"initial_balance"})," (Contexto de Conta):"]})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"initial_balance = Soma de todas as transa\xe7\xf5es da conta com data < primeiro dia do billing_month\n"})}),"\n",(0,d.jsx)(s.p,{children:"Tabelas e opera\xe7\xf5es:"}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"incomes"}),": ",(0,d.jsx)(s.code,{children:"+ amount"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"expenses"}),": ",(0,d.jsx)(s.code,{children:"- amount"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"transfers"}),": ",(0,d.jsx)(s.code,{children:"- amount"})," (source) / ",(0,d.jsx)(s.code,{children:"+ amount"})," (destination)"]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"card_payments"}),": ",(0,d.jsx)(s.code,{children:"- amount"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"investment_deposits"}),": ",(0,d.jsx)(s.code,{children:"- amount"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.code,{children:"investment_withdrawals"}),": ",(0,d.jsx)(s.code,{children:"+ amount"})]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsxs)(s.strong,{children:["C\xe1lculo do ",(0,d.jsx)(s.code,{children:"initial_balance"})," (Contexto de Cart\xe3o):"]})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"initial_balance = card_expenses - card_chargebacks (sem staged_transactions)\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsxs)(s.strong,{children:["C\xe1lculo do ",(0,d.jsx)(s.code,{children:"context_value"})," (Contexto de Conta):"]})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"context_value = initial_balance + transa\xe7\xf5es do m\xeas + staged_transactions\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsxs)(s.strong,{children:["C\xe1lculo do ",(0,d.jsx)(s.code,{children:"context_value"})," (Contexto de Cart\xe3o):"]})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"context_value = initial_balance + staged_transactions\n             = (card_expenses - card_chargebacks) + staged_transactions\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"Concilia\xe7\xe3o:"})," ",(0,d.jsx)(s.code,{children:"status = ok"})," quando ",(0,d.jsx)(s.code,{children:"target_value == context_value"})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"excluir-sess\xe3o",children:"Excluir Sess\xe3o"}),"\n",(0,d.jsx)(s.p,{children:"Remove a sess\xe3o e todas as suas staged transactions."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"DELETE /import-sessions/:id\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"Response:"})," ",(0,d.jsx)(s.code,{children:"204 No Content"})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"commit-session",children:"Commit Session"}),"\n",(0,d.jsxs)(s.p,{children:["Efetiva todas as transa\xe7\xf5es com status ",(0,d.jsx)(s.code,{children:"READY"})," nas tabelas principais do banco."]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"POST /import-sessions/:id/commit\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Comportamento:"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Transa\xe7\xf5es ",(0,d.jsx)(s.code,{children:"READY"})," s\xe3o salvas com status ",(0,d.jsx)(s.code,{children:"VALIDATING"})]}),"\n",(0,d.jsxs)(s.li,{children:["Transa\xe7\xf5es com ",(0,d.jsx)(s.code,{children:"ignore: true"})," no JSON s\xe3o salvas com status ",(0,d.jsx)(s.code,{children:"IGNORE"})]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Processamento de Tags:"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["O sistema verifica os campos ",(0,d.jsx)(s.code,{children:"tags"})," (array de nomes) e ",(0,d.jsx)(s.code,{children:"tag_ids"})," (array de UUIDs) dentro do JSON ",(0,d.jsx)(s.code,{children:"data"})," da transa\xe7\xe3o."]}),"\n",(0,d.jsxs)(s.li,{children:["Tags informadas por nome em ",(0,d.jsx)(s.code,{children:"tags"})," ser\xe3o buscadas ou criadas automaticamente no workspace."]}),"\n",(0,d.jsxs)(s.li,{children:["Tags informadas por ID em ",(0,d.jsx)(s.code,{children:"tag_ids"})," ser\xe3o vinculadas diretamente."]}),"\n",(0,d.jsx)(s.li,{children:"Todas as tags identificadas ser\xe3o associadas \xe0 transa\xe7\xe3o efetivada (Income, Expense, etc)."}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "message": "Session committed successfully"\n}\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"close-session",children:"Close Session"}),"\n",(0,d.jsx)(s.p,{children:"Concilia a sess\xe3o e encerra o processo de importa\xe7\xe3o."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"POST /import-sessions/:id/close\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Comportamento para Contexto de Conta:"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Altera status das transa\xe7\xf5es de ",(0,d.jsx)(s.code,{children:"VALIDATING"})," para ",(0,d.jsx)(s.code,{children:"PAID"})]}),"\n",(0,d.jsx)(s.li,{children:"Exclui a sess\xe3o"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Comportamento para Contexto de Cart\xe3o:"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Altera status das transa\xe7\xf5es de ",(0,d.jsx)(s.code,{children:"VALIDATING"})," para ",(0,d.jsx)(s.code,{children:"PAID"})]}),"\n",(0,d.jsxs)(s.li,{children:["Altera status da fatura para ",(0,d.jsx)(s.code,{children:"PAID"})]}),"\n",(0,d.jsx)(s.li,{children:"Exclui a sess\xe3o"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "message": "Session closed and reconciled successfully"\n}\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"vincular-transa\xe7\xe3o-recorrente",children:"Vincular Transa\xe7\xe3o Recorrente"}),"\n",(0,d.jsx)(s.p,{children:"Vincula uma staged transaction a uma transa\xe7\xe3o recorrente, herdando suas configura\xe7\xf5es."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"POST /import-sessions/:id/bind\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "staged_transaction_id": "uuid-staged-transaction",\n  "recurring_transaction_id": "uuid-recurring-transaction"\n}\n'})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Identifica\xe7\xe3o do tipo de recurring:"})}),"\n",(0,d.jsxs)(s.p,{children:["O sistema busca o ",(0,d.jsx)(s.code,{children:"recurring_transaction_id"})," nas tabelas na seguinte ordem:"]}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Tabela"}),(0,d.jsx)(s.th,{children:"Tipo resultante"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_incomes"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"INCOME"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_expenses"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"EXPENSE"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_transfers"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"TRANSFER"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_card_transactions"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"CARD_EXPENSE"})})]})]})]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Campos herdados pela staged transaction:"})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Campo"}),(0,d.jsx)(s.th,{children:"Origem"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"type"})}),(0,d.jsx)(s.td,{children:"Tipo da recurring"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"data.description"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring.description"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"data.category_id"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring.category_id"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"data.subcategory_id"})}),(0,d.jsxs)(s.td,{children:[(0,d.jsx)(s.code,{children:"recurring.subcategory_id"})," (se existir)"]})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"data.recurring_*_id"})}),(0,d.jsx)(s.td,{children:"ID da recurring vinculada"})]})]})]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsxs)(s.strong,{children:["Campos adicionados ao JSON ",(0,d.jsx)(s.code,{children:"data"}),":"]})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Tipo de Recurring"}),(0,d.jsx)(s.th,{children:"Campo"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Recurring Income"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_income_id"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Recurring Expense"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_expense_id"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Recurring Transfer"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_transfer_id"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Recurring Card Transaction"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"recurring_card_transaction_id"})})]})]})]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Exemplo de resposta da staged transaction ap\xf3s bind:"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-staged",\n  "type": "EXPENSE",\n  "status": "READY",\n  "amount": 49.90,\n  "data": {\n    "description": "Netflix - Assinatura Mensal",\n    "category_id": "uuid-categoria-streaming",\n    "subcategory_id": "uuid-subcategoria-video",\n    "recurring_expense_id": "uuid-recurring-netflix"\n  }\n}\n'})}),"\n",(0,d.jsx)(s.admonition,{title:"Status ap\xf3s bind",type:"info",children:(0,d.jsxs)(s.p,{children:["Se a staged transaction passar a ter todos os campos obrigat\xf3rios ap\xf3s o bind, seu status \xe9 atualizado para ",(0,d.jsx)(s.code,{children:"READY"}),"."]})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "message": "Transaction bound successfully"\n}\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h2,{id:"endpoints-de-staged-transactions",children:"Endpoints de Staged Transactions"}),"\n",(0,d.jsx)(s.h3,{id:"criar-transa\xe7\xf5es",children:"Criar Transa\xe7\xf5es"}),"\n",(0,d.jsx)(s.p,{children:"Cria m\xfaltiplas staged transactions em uma sess\xe3o."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"POST /import-sessions/:id/staged-transactions\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'[\n  {\n    "transaction_date": "2024-01-05",\n    "description": "UBER *VIAGEM",\n    "amount": 50.00\n  },\n  {\n    "transaction_date": "2024-01-06",\n    "description": "PIX RECEBIDO",\n    "amount": -150.00\n  }\n]\n'})}),"\n",(0,d.jsxs)(s.admonition,{title:"Regra de Sinais",type:"tip",children:[(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Contexto de Conta:"})}),(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Positivo \u2192 ",(0,d.jsx)(s.code,{children:"INCOME"})," (receita)"]}),"\n",(0,d.jsxs)(s.li,{children:["Negativo \u2192 ",(0,d.jsx)(s.code,{children:"EXPENSE"})," (despesa)"]}),"\n"]}),(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Contexto de Cart\xe3o:"})}),(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Positivo \u2192 ",(0,d.jsx)(s.code,{children:"CARD_EXPENSE"})," (despesa)"]}),"\n",(0,d.jsxs)(s.li,{children:["Negativo \u2192 ",(0,d.jsx)(s.code,{children:"CARD_CHARGEBACK"})," (estorno)"]}),"\n"]})]}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"Response (201 Created):"})," Array das transa\xe7\xf5es criadas"]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"excluir-todas-as-transa\xe7\xf5es",children:"Excluir Todas as Transa\xe7\xf5es"}),"\n",(0,d.jsx)(s.p,{children:"Remove todas as staged transactions de uma sess\xe3o."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"DELETE /import-sessions/:id/staged-transactions\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"Response:"})," ",(0,d.jsx)(s.code,{children:"204 No Content"})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"obter-transa\xe7\xe3o",children:"Obter Transa\xe7\xe3o"}),"\n",(0,d.jsx)(s.p,{children:"Retorna o objeto completo de uma staged transaction junto com o JSON de atributos."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"GET /staged-transactions/:id\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Response (200 OK):"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "id": "uuid-transaction",\n  "session_id": "uuid-session",\n  "type": "EXPENSE",\n  "status": "READY",\n  "transaction_date": "2024-01-05",\n  "amount": 50.00,\n  "data": {\n    "description": "UBER *VIAGEM",\n    "category_id": "uuid-categoria",\n    "subcategory_id": "uuid-subcategoria"\n  },\n  "line_number": 1\n}\n'})}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"atualizar-transa\xe7\xe3o",children:"Atualizar Transa\xe7\xe3o"}),"\n",(0,d.jsx)(s.p,{children:"Atualiza uma staged transaction substituindo os dados no banco."}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-http",children:"PUT /staged-transactions/:id\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-json",children:'{\n  "type": "EXPENSE",\n  "status": "READY",\n  "transaction_date": "2024-01-05",\n  "amount": 55.00,\n  "data": {\n    "description": "UBER *VIAGEM CORRIGIDO",\n    "category_id": "uuid-nova-categoria",\n    "tags": ["Viagem", "Uber"],\n    "tag_ids": ["uuid-tag-existente"]\n  }\n}\n'})}),"\n",(0,d.jsx)(s.admonition,{title:"Valida\xe7\xf5es",type:"warning",children:(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["Os campos principais (",(0,d.jsx)(s.code,{children:"transaction_date"}),", ",(0,d.jsx)(s.code,{children:"amount"}),") n\xe3o podem ser nulos ou inv\xe1lidos"]}),"\n",(0,d.jsxs)(s.li,{children:["O ",(0,d.jsx)(s.code,{children:"type"})," deve respeitar as constantes v\xe1lidas"]}),"\n",(0,d.jsxs)(s.li,{children:["O campo ",(0,d.jsx)(s.code,{children:"data"})," (JSON) n\xe3o passa por valida\xe7\xe3o de schema"]}),"\n"]})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"Response (200 OK):"})," Transa\xe7\xe3o atualizada"]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h2,{id:"tipos-e-enums",children:"Tipos e Enums"}),"\n",(0,d.jsx)(s.h3,{id:"stagedtransactiontype",children:"StagedTransactionType"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Contexto de Conta:"})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Valor"}),(0,d.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"INCOME"})}),(0,d.jsx)(s.td,{children:"Receita"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"EXPENSE"})}),(0,d.jsx)(s.td,{children:"Despesa"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"TRANSFER"})}),(0,d.jsx)(s.td,{children:"Transfer\xeancia entre contas"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"CARD_PAYMENT"})}),(0,d.jsx)(s.td,{children:"Pagamento de fatura de cart\xe3o"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"INVESTMENT_DEPOSIT"})}),(0,d.jsx)(s.td,{children:"Dep\xf3sito em investimentos"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"INVESTMENT_WITHDRAWAL"})}),(0,d.jsx)(s.td,{children:"Saque de investimentos"})]})]})]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"Contexto de Cart\xe3o:"})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Valor"}),(0,d.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"CARD_EXPENSE"})}),(0,d.jsx)(s.td,{children:"Despesa de cart\xe3o"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"CARD_CHARGEBACK"})}),(0,d.jsx)(s.td,{children:"Estorno de cart\xe3o"})]})]})]}),"\n",(0,d.jsx)(s.h3,{id:"stagedtransactionstatus",children:"StagedTransactionStatus"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Valor"}),(0,d.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"PENDING"})}),(0,d.jsx)(s.td,{children:"Faltam informa\xe7\xf5es para salvar na base"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"READY"})}),(0,d.jsx)(s.td,{children:"Pronta para ser efetivada"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"PROCESSING"})}),(0,d.jsx)(s.td,{children:"Sendo processada pela IA"})]})]})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h2,{id:"c\xf3digos-de-erro",children:"C\xf3digos de Erro"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"C\xf3digo"}),(0,d.jsx)(s.th,{children:"Descri\xe7\xe3o"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"400"})}),(0,d.jsx)(s.td,{children:"Request inv\xe1lido (falta account_id ou card_id, fatura n\xe3o est\xe1 OPEN, etc.)"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"401"})}),(0,d.jsx)(s.td,{children:"N\xe3o autorizado"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"403"})}),(0,d.jsx)(s.td,{children:"Permiss\xe3o insuficiente"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"404"})}),(0,d.jsx)(s.td,{children:"Sess\xe3o ou transa\xe7\xe3o n\xe3o encontrada"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"500"})}),(0,d.jsx)(s.td,{children:"Erro interno do servidor"})]})]})]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}},8453(e,s,n){n.d(s,{R:()=>c,x:()=>a});var r=n(6540);const d={},i=r.createContext(d);function c(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:c(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);