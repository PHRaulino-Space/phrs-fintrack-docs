// ENUM Definitions
Enum "account_type" {
  checking
  savings
  wallet
  investment
}

Enum "currency" {
  BRL
  USD
  EUR
}

Enum "investment_type" {
  renda_fixa
  renda_variavel
  tesouro_direto
}

Enum "index_type" {
  CDI
  IPCA
  SELIC
  FIXED
}

Enum "liquidity_type" {
  daily
  monthly
  at_maturity
}

Enum "invoice_status" {
  open
  paid
  overdue
}

Enum "transaction_frequency" {
  daily
  weekly
  biweekly
  monthly
  bimonthly
  quarterly
  yearly
}

Enum "sync_type" {
  incomes
  expenses
  card_expenses
  card_chargebacks
  card_payments
  transfers
  recurring_transactions
  investment_deposit
  investment_withdrawal
  investments
}

Enum "integrations" {
  mobills
}

Table "users" {
  "id" UUID [pk]
  "name" VARCHAR(100) [not null]
  "email" VARCHAR(100) [unique, not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "accounts" {
  "id" UUID [pk]
  "user_id" UUID [not null]
  "name" VARCHAR(100) [not null]
  "type" account_type [not null]
  "initial_balance" NUMERIC(15,2) [not null]
  "currency" currency [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "categories" {
  "id" UUID [pk]
  "name" VARCHAR(100) [not null]
  "color" VARCHAR(100) [not null]
  "icon" VARCHAR(100) [not null]
  "transaction_type" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "subcategories" {
  "id" UUID [pk]
  "name" VARCHAR(100) [not null]
  "category_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "transaction_statuses" {
  "id" UUID [pk]
  "name" VARCHAR(50) [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "cards" {
  "id" UUID [pk]
  "name" VARCHAR(100) [not null]
  "credit_limit" "NUMERIC(15, 2)" [not null]
  "account_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "invoices" {
  "id" UUID [pk]
  "card_id" UUID [not null]
  "billing_month" DATE [not null]
  "due_date" DATE [not null]
  "status" invoice_status [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}


Table "transfers" {
  "id" UUID [pk]
  "transfer_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "source_account_id" UUID [not null]
  "destination_account_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "recurring_transactions" {
  "id" UUID [pk]
  "amount" NUMERIC(15, 2) [not null]
  "description" VARCHAR(50) [not null]
  "frequency" transaction_frequency [not null]
  "start_date" DATE [not null]
  "end_date" DATE
  "account_id" UUID [not null]
  "category_id" UUID [not null]
  "subcategory_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}


Table "investments" {
  "id" UUID [pk]
  "asset_name" VARCHAR(100) [not null]
  "type" investment_type [not null]
  "account_id" UUID [not null]
  "index_type" index_type
  "index_value" VARCHAR(50)
  "liquidity" liquidity_type
  "fl_rescued" BOOLEAN
  "validity" DATE
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "tags" {
  "id" UUID [pk]
  "name" VARCHAR(100) [not null]
  "color" VARCHAR(20)
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "recurring_transactions_tags" {
  "recurring_transactions_id" UUID [not null]
  "tag_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "incomes" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "account_id" UUID [not null]
  "recurring_transaction_id" UUID
  "category_id" UUID [not null]
  "subcategory_id" UUID
  "transaction_status_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "expenses" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "account_id" UUID [not null]
  "category_id" UUID [not null]
  "subcategory_id" UUID
  "transaction_status_id" UUID [not null]
  "recurring_transaction_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "card_expenses" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "subcategory_id" UUID
  "category_id" UUID
  "recurring_transaction_id" UUID
  "invoice_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "card_chargebacks" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "invoice_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "card_payments" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "amount" "NUMERIC(15, 2)" [not null]
  "account_id" UUID [not null]
  "invoice_id" UUID
  "is_finalized" BOOLEAN
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "investment_deposit" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "recurring_transaction_id" UUID
  "investment_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "investment_withdrawal" {
  "id" UUID [pk]
  "transaction_date" DATE [not null]
  "description" TEXT
  "amount" "NUMERIC(15, 2)" [not null]
  "recurring_transaction_id" UUID
  "investment_id" UUID
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "incomes_tags" {
  "income_id" UUID [not null]
  "tag_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "expenses_tags" {
  "expense_id" UUID [not null]
  "tag_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "investments_tags" {
  "investment_id" UUID [not null]
  "tag_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "card_expense_tags" {
  "card_expense_id" UUID [not null]
  "tag_id" UUID [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "transactions_types" {
  "id" UUID [pk]
  "name" VARCHAR(50) [not null]
  "created_at" timestamp [default: `now()`]
  "updated_at" timestamp [default: `now()`]
}

Table "external_sync" {
  "id" UUID [pk]
  "id_local" UUID [not null]
  "id_mobills" UUID [not null]
  "type" sync_type [not null]
  "source" integrations [not null]
  "created_at" timestamp [default: `now()`]
}

Ref:"users"."id" < "accounts"."user_id"

Ref:"transactions_types"."id" < "categories"."transaction_type"

Ref:"categories"."id" < "subcategories"."category_id"

Ref:"accounts"."id" < "cards"."account_id"

Ref:"cards"."id" < "invoices"."card_id"

Ref:"accounts"."id" < "transfers"."source_account_id"

Ref:"accounts"."id" < "transfers"."destination_account_id"

Ref:"accounts"."id" < "recurring_transactions"."account_id"

Ref:"categories"."id" < "recurring_transactions"."category_id"

Ref:"subcategories"."id" < "recurring_transactions"."subcategory_id"

Ref:"accounts"."id" < "investments"."account_id"

Ref:"recurring_transactions"."id" < "recurring_transactions_tags"."recurring_transactions_id"

Ref:"tags"."id" < "recurring_transactions_tags"."tag_id"

Ref:"accounts"."id" < "incomes"."account_id"

Ref:"recurring_transactions"."id" < "incomes"."recurring_transaction_id"

Ref:"categories"."id" < "incomes"."category_id"

Ref:"subcategories"."id" < "incomes"."subcategory_id"

Ref:"transaction_statuses"."id" < "incomes"."transaction_status_id"

Ref:"accounts"."id" < "expenses"."account_id"

Ref:"categories"."id" < "expenses"."category_id"

Ref:"subcategories"."id" < "expenses"."subcategory_id"

Ref:"transaction_statuses"."id" < "expenses"."transaction_status_id"

Ref:"recurring_transactions"."id" < "expenses"."recurring_transaction_id"

Ref:"subcategories"."id" < "card_expenses"."subcategory_id"

Ref:"categories"."id" < "card_expenses"."category_id"

Ref:"recurring_transactions"."id" < "card_expenses"."recurring_transaction_id"

Ref:"invoices"."id" < "card_expenses"."invoice_id"

Ref:"invoices"."id" < "card_chargebacks"."invoice_id"

Ref:"accounts"."id" < "card_payments"."account_id"

Ref:"invoices"."id" < "card_payments"."invoice_id"

Ref:"recurring_transactions"."id" < "investment_deposit"."recurring_transaction_id"

Ref:"investments"."id" < "investment_deposit"."investment_id"

Ref:"recurring_transactions"."id" < "investment_withdrawal"."recurring_transaction_id"

Ref:"investments"."id" < "investment_withdrawal"."investment_id"

Ref:"incomes"."id" < "incomes_tags"."income_id"

Ref:"tags"."id" < "incomes_tags"."tag_id"

Ref:"expenses"."id" < "expenses_tags"."expense_id"

Ref:"tags"."id" < "expenses_tags"."tag_id"

Ref:"investments"."id" < "investments_tags"."investment_id"

Ref:"tags"."id" < "investments_tags"."tag_id"

Ref:"card_expenses"."id" < "card_expense_tags"."card_expense_id"

Ref:"tags"."id" < "card_expense_tags"."tag_id"
