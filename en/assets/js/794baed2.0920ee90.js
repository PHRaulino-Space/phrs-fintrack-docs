"use strict";(globalThis.webpackChunkgh_docs=globalThis.webpackChunkgh_docs||[]).push([[1573],{1126(e,n,o){o.r(n),o.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"api-reference/authentication","title":"Autentica\xe7\xe3o","description":"O FinTrack implementa um sistema de autentica\xe7\xe3o h\xedbrido, suportando login nativo (E-mail/Senha) e OAuth 2.0 (ex: GitHub). O gerenciamento de sess\xe3o \xe9 feito primariamente via Cookies seguros (HttpOnly), garantindo maior seguran\xe7a contra ataques XSS.","source":"@site/docs/api-reference/authentication.md","sourceDirName":"api-reference","slug":"/api-reference/authentication","permalink":"/fintrack-docs/en/docs/api-reference/authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/PHRaulino-Space/fintrack-docs/tree/main/gh-docs/docs/api-reference/authentication.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Infraestrutura","permalink":"/fintrack-docs/en/docs/architecture/infrastructure"},"next":{"title":"API Keys","permalink":"/fintrack-docs/en/docs/api-reference/api-keys"}}');var i=o(4848),r=o(8453);const d={},c="Autentica\xe7\xe3o",t={},a=[{value:"Mecanismo de Sess\xe3o",id:"mecanismo-de-sess\xe3o",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"1. Registro (Nativo)",id:"1-registro-nativo",level:3},{value:"2. Login (Nativo)",id:"2-login-nativo",level:3},{value:"3. Login com OAuth (Social)",id:"3-login-com-oauth-social",level:3},{value:"4. Callback OAuth",id:"4-callback-oauth",level:3},{value:"5. Validar Sess\xe3o",id:"5-validar-sess\xe3o",level:3},{value:"6. Logout",id:"6-logout",level:3}];function l(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"autentica\xe7\xe3o",children:"Autentica\xe7\xe3o"})}),"\n",(0,i.jsxs)(n.p,{children:["O FinTrack implementa um sistema de autentica\xe7\xe3o h\xedbrido, suportando login nativo (E-mail/Senha) e OAuth 2.0 (ex: GitHub). O gerenciamento de sess\xe3o \xe9 feito primariamente via Cookies seguros (",(0,i.jsx)(n.code,{children:"HttpOnly"}),"), garantindo maior seguran\xe7a contra ataques XSS."]}),"\n",(0,i.jsx)(n.h2,{id:"mecanismo-de-sess\xe3o",children:"Mecanismo de Sess\xe3o"}),"\n",(0,i.jsxs)(n.p,{children:["O sistema utiliza o cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"})," para armazenar o JWT (JSON Web Token) de acesso."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cookie Name:"})," ",(0,i.jsx)(n.code,{children:"fintrack_token"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Atributos:"})," ",(0,i.jsx)(n.code,{children:"HttpOnly"}),", ",(0,i.jsx)(n.code,{children:"Path=/"}),", ",(0,i.jsx)(n.code,{children:"SameSite=Lax"}),", ",(0,i.jsx)(n.code,{children:"MaxAge=24h"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Seguran\xe7a:"})," O cookie n\xe3o \xe9 acess\xedvel via JavaScript no frontend."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,i.jsx)(n.h3,{id:"1-registro-nativo",children:"1. Registro (Nativo)"}),"\n",(0,i.jsx)(n.p,{children:"Cria uma nova conta de usu\xe1rio no sistema."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"POST"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/register"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Jo\xe3o da Silva",\n  "email": "joao@exemplo.com",\n  "password": "senha-forte-123"\n}\n'})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Obrigat\xf3rio"}),(0,i.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Sim"}),(0,i.jsx)(n.td,{children:"Nome completo do usu\xe1rio"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"email"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Sim"}),(0,i.jsx)(n.td,{children:"Endere\xe7o de e-mail (deve ser \xfanico)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"password"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Sim"}),(0,i.jsx)(n.td,{children:"Senha (min. 8 caracteres)"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response (201 Created):"}),"\n",(0,i.jsx)(n.em,{children:"Sucesso (sem corpo de resposta)"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2-login-nativo",children:"2. Login (Nativo)"}),"\n",(0,i.jsxs)(n.p,{children:["Autentica um usu\xe1rio existente e inicia a sess\xe3o definindo o cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"POST"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/login"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "email": "joao@exemplo.com",\n  "password": "senha-forte-123"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "message": "Login successful"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Nota: O cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"})," \xe9 setado automaticamente no header ",(0,i.jsx)(n.code,{children:"Set-Cookie"})," da resposta."]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3-login-com-oauth-social",children:"3. Login com OAuth (Social)"}),"\n",(0,i.jsx)(n.p,{children:"Inicia o fluxo de autentica\xe7\xe3o com um provedor externo (ex: GitHub)."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"GET"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/{provider}/login"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Par\xe2metros de Rota:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"provider"}),": Nome do provedor (ex: ",(0,i.jsx)(n.code,{children:"github"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Query Params (Opcional):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"redirect_to"}),": Caminho do frontend para onde o usu\xe1rio deve ser redirecionado ap\xf3s o login (ex: ",(0,i.jsx)(n.code,{children:"/dashboard"}),"). Salvo no cookie ",(0,i.jsx)(n.code,{children:"fintrack_post_login_redirect"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Comportamento:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Gera um ",(0,i.jsx)(n.code,{children:"state"})," aleat\xf3rio para prote\xe7\xe3o CSRF e o salva no cookie ",(0,i.jsx)(n.code,{children:"oauth_state"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Redireciona o navegador para a p\xe1gina de autoriza\xe7\xe3o do provedor (HTTP 307)."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"4-callback-oauth",children:"4. Callback OAuth"}),"\n",(0,i.jsx)(n.p,{children:"Endpoint de retorno do provedor OAuth. Processa o c\xf3digo de autoriza\xe7\xe3o e finaliza o login."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"GET"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/{provider}/callback"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Par\xe2metros:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code"}),": C\xf3digo de autoriza\xe7\xe3o retornado pelo provedor."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state"}),": Token de valida\xe7\xe3o CSRF (deve coincidir com o cookie ",(0,i.jsx)(n.code,{children:"oauth_state"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Comportamento:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Valida o ",(0,i.jsx)(n.code,{children:"state"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Troca o ",(0,i.jsx)(n.code,{children:"code"})," por um token de acesso junto ao provedor."]}),"\n",(0,i.jsx)(n.li,{children:"Cria ou atualiza o usu\xe1rio no banco de dados."}),"\n",(0,i.jsxs)(n.li,{children:["Gera o JWT e define o cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Redireciona o usu\xe1rio para o frontend (baseado no cookie ",(0,i.jsx)(n.code,{children:"fintrack_post_login_redirect"})," ou ",(0,i.jsx)(n.code,{children:"/"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"5-validar-sess\xe3o",children:"5. Validar Sess\xe3o"}),"\n",(0,i.jsx)(n.p,{children:"Verifica se o usu\xe1rio est\xe1 autenticado e retorna seus dados b\xe1sicos e workspaces."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"GET"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/validate"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Header Obrigat\xf3rio:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"})," v\xe1lido."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "status": "valid",\n  "user": {\n    "id": "uuid-usuario",\n    "name": "Jo\xe3o da Silva",\n    "email": "joao@exemplo.com"\n  },\n  "workspaces": [\n    {\n      "id": "uuid-workspace-1",\n      "name": "Pessoal",\n      "role": "admin",\n      "created_at": "2024-01-01T10:00:00Z",\n      "updated_at": "2024-01-01T10:00:00Z"\n    },\n    {\n      "id": "uuid-workspace-2",\n      "name": "Empresa",\n      "role": "member",\n      "created_at": "2024-01-05T14:30:00Z",\n      "updated_at": "2024-01-05T14:30:00Z"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response (401 Unauthorized):"}),"\nSe o token for inv\xe1lido, expirado ou n\xe3o estiver presente."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"6-logout",children:"6. Logout"}),"\n",(0,i.jsx)(n.p,{children:"Encerra a sess\xe3o do usu\xe1rio."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,i.jsx)(n.code,{children:"POST"}),"\n",(0,i.jsx)(n.strong,{children:"Rota:"})," ",(0,i.jsx)(n.code,{children:"/auth/logout"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Comportamento:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Invalida o cookie ",(0,i.jsx)(n.code,{children:"fintrack_token"})," (define MaxAge como -1)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response (200 OK):"}),"\n",(0,i.jsx)(n.em,{children:"Sucesso (sem corpo de resposta)"})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,n,o){o.d(n,{R:()=>d,x:()=>c});var s=o(6540);const i={},r=s.createContext(i);function d(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);